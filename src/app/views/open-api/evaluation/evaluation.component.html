<div>
  <div class="row">
    <div class="col d-flex justify-content-center">
      <h1>Welcome to the evaluation process, please read the instructions and remarks first!</h1>
    </div>
  </div>
  <div class="row">
    <div class="col d-flex justify-content-center">
      <mat-form-field appearance="outline" class="flex-grow-1">
        <mat-label>Task</mat-label>
        <mat-select [disabled]="taskService.TaskRunning" [formControl]="task">
          <mat-option *ngFor="let task of tasks" [value]="task">
            {{task.name}}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
  </div>
  <div class="row" *ngIf="task.value as task">
    <div class="col">
      <mat-card class="color-primary">
        <mat-card-header>
          <mat-card-title>{{task.name}}</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          {{task.description}}
        </mat-card-content>
        <mat-card-actions align="end">
          <button *ngIf="!taskService.TaskRunning" mat-raised-button (click)="startTask(task)">Start</button>
          <ng-container *ngIf="taskService.TaskRunning">
            <button mat-raised-button color="warn" (click)="abortTask()">Abort</button>
            <button mat-raised-button (click)="startTask(task)">Continue</button>
          </ng-container>
        </mat-card-actions>
      </mat-card>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <mat-card>
        <mat-card-content>
          Please read the following instructions the task carefully!
          <br><br>
          <ul>
          <li>The goal of this evaluation is to collect engineering data for formalizing mappings 
            of HTTP-Request and -Responses Mappings based on JSON-Attributes. There exist a manual and a supported version for doing so.</li>
          <li>Unless explicitly indicated otherwise, you will only work with "OpenAPI"</li>
            <ul>
              <li>The "MANUAL" method is equivalent to implementing a software adpater using an IDE (e.g. Visual Studio Code)</li>
              <li>The "SUPPORTED" method using a code generator to abstract and may be reusing already present mappings stored in a knowledge base</li>
            </ul>
          <li>The evaluation period will last from 21.10.2020 until 16.12.2020</li>
          <li>You may need longer for solving the tasks in the beginning. Expect for tasks up to 60 minutes of workload per week.
          </li>
          <li>Please familiarize yourself with the tool first. Therefore, please select "Server Endpoint - Example1" as a Mapping Source and "Server Endpoint - Example2" as a Mapping Target</li>
          <li>Use Case: The overall storyline from a software engineers point of view is the following:</li>
          <ul>
            <li>Imagine you are the owner of an IoT application running on your smartphone</li>
            <li>This application is reading and writing sensor values from an temperature sensor</li>
            <li>During the initial implementation, the software engineer decided to call a concrete http service running on a device which was
              manufactured by SIEMENS
            </li>
            <li>Now, the SIEMENS device endpoint should be replaced with a device endpoint offered by APPLE</li>
            <li>As the application logic should not be changed, your are required a software adapter that transforms the values received
              from the APPLE device to values from the SIEMENS device
            </li>
          </ul>
          <li>There are several depencendies when working on the tasks listed. These are defined as follows:</li>
          <br>
          <b>Tasks valid from 11.11.2020 until 18.11.2020. Last possible submission date is 18.11.2020 14:00 Romanian Time/15:00 German Time.</b>
          <table style="width:100%; text-align:center;" border="1">
            <tr>
              <th>Taskname</th>
              <th>Dependend on</th>
              <th>Participant</th>
              <th>Inform next Participant</th>
            </tr>
            <tr>
              <td>SUPPORTED Samsung - LG</td>
              <td>-</td>
              <td>Mark, Miruna</td>
              <th>-</th>
            </tr>
            <tr>
              <td>SUPPORTED LG - Epson</td>
              <td>-</td>
              <td>Miruna, Sven</td>
              <th>-</th>
            </tr>
            <tr>
              <td>SUPPORTED Samsung - Epson</td>
              <td>-</td>
              <td>Mark, Sven</td>
              <th>-</th>
            </tr>
            <tr>
              <td>MANUAL Samsung - LG</td>
              <td>-</td>
              <td>Sven</td>
              <th>-</th>
            </tr>
            <tr>
              <td>MANUAL LG - Epson</td>
              <td>-</td>
              <td>Mark</td>
              <th>-</th>
            </tr>
            <tr>
              <td>MANUAL Samsung - Epson</td>
              <td>-</td>
              <td>Miruna</td>
              <th>-</th>
            </tr>
          </table>
        </ul>
        Process of executing a Task:
        <br><br>
        <ol>
          <li>Choose the assigned tasks to your name indicated by "Participant" from the dropdown menu "Task"
          <ul>
            <li>If the colum "Dependend is not empty, you need to wait until you are informed by the other participant (e.g. via Discord, ..) 
            that they have finished their task</li>
            <li>If the colum "Inform next Participant" is not empty, please inform the mentioned participant (e.g. via Discord, ..)
              that the task has been finished.
            </li>
            <li>In every other scenario, just start with the task
            </li>
          </ul>
        </li>
          <li>Click on "Start"
          <ul>
            <li>Web UI functionality for SUPPORTED Tasks</li>
            <ul>
              <li>Select pairs of attributes from the left and right by clicking on them based on your interpretation</li>
              <li>After selecting one attribute from each side, click on "Map Selceted"</li>
              <li>For Request Mappings, all attributes from the "Target Request Body" must be mapped</li>
              <li>For Response Mappings, all attributes from the "Source Response Body" must be mapped</li>
              <li>If some mappings are prefilled, you can reuse them immmediatly</li>
            </ul>
            <li>Web UI functionality for MANUAL Tasks</li>
            <ul>
              <li>These types of tasks do not allow for creating mappings within the User Interface</li>
              <li>The tool supports you only in generating the software adpater project</li>
              <li>Hence, please read the upcoming transformations regarding "testcase is unsuccessfull" carefully</li>
            </ul>
          </ul>
        </li>
        <li>SUPPORTED TASKS ONLY: You can test your mapping at any time using the "Test Mapping" functionality 
          <ul>
            <li>By clicking on "Test Request" all available request mappings are applied to the "Source Request Body" and send to the "Maping Target"</li>
            <li>Similar, all available response mappings are applied to the repsonse from the "Mapping Target" </li>
            <li>You do not have to specify any input parameters</li>
            <li>If your mappings are correct, then you sould see a valid response with the attrbutes of the "Source Request Body" in the "Output Data" field</li>
          </ul>
        </li>
        <li>Next, you will need to generate the software adapter</li>
        <ul>
          <li>When you click on "Build Adapter", you will receive an authentification toke</li>
          <li>This token must be copied and inserted on the website that wull be opened up automatically</li>
          <li>Within this new window (Visual Studio Code as a web version), you have to perform the following steps</li>
          <li>First, open a new terminal by opening the menu in the upper left corner (click on three horizontal lines) and select Terminal -> New Terminal</li>
          <li>Next, you have to excute "sh project/install.sh ". This will install all required depencendies - Please wait until finished</li>
          <li>Then, you have to switch into the project folder by executing "cd project"</li>
          <li>Next, please open up the file project/test.js</li>
          <ul>
            <li>Insert your email-address and password that you also use to login into the tool at place "TODO1"</li>
            <li>Open the file project/source/src/api/DefaultApi.js and copy ONLY the method name of the last method</li>
            <li>Insert this method name in the test.js at "TODO2" after "ApiInterface.CHANGE_THIS_METHOD_NAME"</li>
          </ul>
          <li>Now, you can execute "node test.js" to check whether your adapter has been generated successfully</li>
          <li>If the testcase is successfull, you can proceed with the next step presented in the terminal</li>
          <li>If the testcase is unsuccessfull, you need to adapt the generated code manually</li>
          <ul>
            <li>Therefore, you have to implement the method "getAddressWithHttpInfo" in project/source/src/api/DefaultApi.js</li>
            <li>First, you have to call all provided APIs from the target folder</li>
            <li>You can check which methods are available by having a look in all files found under project/targets/.../src/api/DefaultApi.js. Each last method name is callable
              and backed up by a real service</li>
            <li>Each received JSON from these target services can be used to create required json file by the provided source service</li>
            <li>Again, as soon "node test.js" passes, you can proceed with the next step presented in the terminal</li>
          </ul>
          <ul>
            <li>If you face any unsolvable difficulties, please also continue with the next step</li>
            <li>Please send a short notice to <a href="mailto:burzlaff@es.uni-mannheim.de">burzlaff@es.uni-mannheim.de</a> why you could not finish the task
            including the displayed error message, if available.</li>
          </ul>
        </ul>
        <li> You can finish your task by clicking on "Finish Task"
          <ul>
            <li>When your task is finished, you will see a corresponding message. Please inform Fabian shortly in the Discord channel "#general"</li>
            <li>If there exist any error, then an Error-Message will be displayed at the bottom of the site</li>
          </ul>
        </li>
          <li>You can abort abort a task or reset the application at any time
          <ul>
            <li>In the "Task Overview", clicking on "Abort" may be required if you selcted the wrong task</li>
            <li>In the "Mapping Overview", clicking on "Reset" may be required if you want to reset all UI elements </li>
          </ul>
        </li>
        </ol>
          Please note the following remarks for working with this prototype:
          <br><br>
          <ul>
          <li>You can navigate back to the start page at any time by clicking on "HOME"</li>
          <li>You can open multiple tabs displaying different site content at the same time</li>
          <li>If you cannot find a button or other UI elements, try to scroll up and down</li>
          <li>Try not to use the refresh functionality of your browser (e.g. STRG+R). This may result in loss of unsaved work</li>
          <li>When you start a task, the time is measured automatically</li>
          <li>If you close your web ide by accident, you should abort and restart your task</li>
          <li>As soon as "node test.js" passes all tests, the web ide will be automatically terminated after a few seconds</li>
          <li>You can also send any suggestions for improvements (e.g. annotated screenshot) at any 
            time to <a href="mailto:burzlaff@es.uni-mannheim.de">burzlaff@es.uni-mannheim.de</a></li>
          </ul>
        </mat-card-content>
      </mat-card>
    </div>
  </div>
</div>
